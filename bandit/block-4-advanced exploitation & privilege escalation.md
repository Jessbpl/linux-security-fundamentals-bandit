# Block 4 – Advanced Exploitation & Git Interaction
Levels: 25–33

## Overview

This block focuses on advanced Git analysis, remote repository interaction, server-side validation, and escaping restricted shells. It demonstrates how attackers and defenders analyze version control systems and bypass environment restrictions.


## Level 25 → Level 26

### Objective:
Retrieve a password stored in a hidden file located inside a directory with restricted access.

### Context:
The password is stored in a file with unusual permissions inside a directory that is not listed by default commands. Proper enumeration is required.

### Commands Used:
```bash
# Copy SSH key from Bandit25 to Mac
cat ~/bandit26.sshkey > ~/bandit26.sshkey

# Set correct permissions
chmod 600 ~/bandit26.sshkey

# SSH into Bandit26 using the key
ssh -i ~/bandit26.sshkey bandit26@bandit.labs.overthewire.org -p 2220

# Inside 'more', open vi and spawn a shell
:set shell=/bin/bash
:shell

# Retrieve password
cat /etc/bandit_pass/bandit27
```

### Explanation:
The restricted shell prevents direct access to a normal prompt.
By shrinking the terminal and using more + vim, we spawn a real shell.
The SUID program bandit27-do is required for executing commands as bandit27.

### Security Concepts:
Restricted shell environments
SUID permissions
SSH key-based authentication

### Relevance to Cybersecurity:
Understanding restricted shells and SUID programs helps in privilege escalation analysis and penetration testing.


## Level 26 → Level 27

### Objective:
Use the SUID program bandit27-do to read the password for Bandit27.

### Context:
Direct access to the password file is not allowed for Bandit26. The SUID program runs as Bandit27, allowing you to execute commands with its privileges.

### Commands Used:
```bash
# Run the SUID program to read the next password
./bandit27-do cat /etc/bandit_pass/bandit27

# SSH into Bandit27 using the retrieved password
ssh bandit27@bandit.labs.overthewire.org -p 2220
```

### Explanation:
SUID programs allow executing commands with the file owner’s privileges.
bandit27-do lets Bandit26 execute cat /etc/bandit_pass/bandit27 as Bandit27, bypassing normal restrictions.

### Security Concepts:
SUID permission usage
Privilege escalation
File ownership and access control

### Relevance to Cybersecurity:
Understanding SUID and privilege escalation is critical for auditing permissions and detecting potential security risks.


##Level 27 → Level 28

### Objective:
Retrieve a password for Bandit28 from a Git repository via SSH.

### Context:
The password is stored in a Git repository on the Bandit27 server. It must be cloned and inspected locally.

### Commands Used:
```bash
# From Mac terminal, clone the repository
git clone ssh://bandit27-git@bandit.labs.overthewire.org:2220/home/bandit27-git/repo

# Enter the cloned folder
cd repo

# Read the password
cat README

# SSH into Bandit28 using the retrieved password
ssh bandit28@bandit.labs.overthewire.org -p 2220
```

### Explanation:
Git over SSH allows secure repository access.
The password file (README) contains the next level’s password.
This emphasizes interacting with Git remotely rather than on the server.

### Security Concepts:
Git repository access over SSH
Version control security
Remote authentication

### Relevance to Cybersecurity:
Multiple layers of compression or encoding are common in malware delivery or exfiltration. Analysts must know how to extract and analyze content.


## Level 28 → Level 29

### Objective:
Access a password stored in a service requiring port scanning and network communication.

### Context:
The repository has been modified to hide the password in the latest commit. You need to examine older commits to find the original password.

### Commands Used:
```bash
# Check Git commit history
git log

# Show previous version of README containing the password
git show <commitID>:README.md

# SSH into Bandit29 using the retrieved password
ssh bandit29@bandit.labs.overthewire.org -p 2220
```

### Explanation:
Git keeps a complete history of commits; even if the latest file hides the password, older commits retain it.
Viewing previous commits allows retrieval of hidden or overwritten data.

### Security Concepts:
Git history and version control integrity
Forensic recovery from versioned files
SSH-based repository access

### Relevance to Cybersecurity:
Understanding how to recover data from version control systems is critical during security audits and incident response.


## Level 29 → Level 30

### Objective
Retrieve the Bandit 30 password by analyzing a Git repository and inspecting historical file versions.

### Context
The password is not visible in the latest repository files. It is hidden in previous commits or file snapshots inside the Git history.

### Commands Used
```bash
ssh bandit29@bandit.labs.overthewire.org -p 2220

git clone ssh://bandit29-git@bandit.labs.overthewire.org:2220/home/bandit29-git/repo
cd repo

ls
git log --oneline
git show <commit-hash>:README.md

git rev-list --all | while read rev; do git ls-tree -r $rev; done
git show <blob-hash>
```

### Explanation
The repository was cloned locally for inspection.
git log revealed commit history.
Previous commits contained different versions of README.md.
File snapshots (blobs) were inspected to recover the hidden password.

### Security Concepts
Git version history analysis
Data recovery from version control
Repository forensic investigation

### Relevance to Cybersecurity
Sensitive data may remain accessible in version control history even after removal. Security professionals must audit repositories for exposed secrets.


## Level 30 → Level 31

### Objective
Find the password hidden in Git metadata rather than commits.

### Context
The repository contained only one commit and no visible credentials. The password was hidden in a Git tag.

### Commands Used
```bash
git clone ssh://bandit30-git@bandit.labs.overthewire.org:2220/home/bandit30-git/repo
cd repo

git log
git tag
git show secret
```

### Explanation
The commit history did not contain the password.
git tag revealed a tag named secret.
Inspecting the tag exposed the password.

### Security Concepts
Git tags and metadata storage
Hidden data in version control systems
Information disclosure risks

### Relevance to Cybersecurity
Attackers often inspect repository metadata (tags, branches, stash) to recover hidden credentials.


## Level 31 → Level 32

### Objective
Push a specific file to a remote repository while bypassing .gitignore restrictions.

### Context
The repository required pushing a file containing a specific phrase. A .gitignore rule prevented .txt files from being tracked.

### Commands Used
```bash
git clone ssh://bandit31-git@bandit.labs.overthewire.org:2220/home/bandit31-git/repo
cd repo

echo "May I come in?" > key.txt
git add -f key.txt
git commit -m "Fix key"
git push origin master
```

### Explanation
A file with required content was created.
.gitignore blocked .txt files.
git add -f forced Git to track the file.
The remote server validated the push and returned the password.

### Security Concepts
.gitignore rules
Forced file tracking
Remote repository validation
Server-side Git hooks

### Relevance to Cybersecurity
This demonstrates how remote servers validate code automatically, similar to CI/CD pipelines and security checks.


## Level 32 → Level 33

### Objective
Escape a restricted uppercase shell to access the password.

### Context
The shell automatically converted all commands to uppercase, causing standard commands to fail.

### Commands Used
```bash
$0
cat /etc/bandit_pass/bandit33
```

### Explanation
The shell forced all input to uppercase, blocking normal commands.
$0 launches the current shell internally and bypasses input conversion.
A normal shell was spawned, allowing password retrieval.

### Security Concepts
Restricted shell environments
Shell escape techniques
Environment variables
Command execution control

### Relevance to Cybersecurity
Understanding restricted environment bypass techniques is essential for penetration testing and system hardening.
